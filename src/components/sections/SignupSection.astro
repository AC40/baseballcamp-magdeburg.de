<section class="section pt-0! mt-0">
  <div class="max-w-2xl mx-auto">
    <div class="card">
      <form
        action="https://api.web3forms.com/submit"
        method="POST"
        class="space-y-0"
        id="signup-form"
      >
        <input type="hidden" name="access_key" value="03f3b4a3-d2e9-40d4-8cef-a3d67718637d" />
        <input type="hidden" name="subject" value="Neue Anmeldung - Magdeburger Baseball Camp" />
        <input type="hidden" name="from_name" value="Baseball Camp Anmeldung" />
        
        <div id="form-status" role="alert" aria-live="polite" tabindex="-1" class="hidden p-4 rounded border-2 border-white font-bold text-center"></div>

        <!-- Teilnehmer-Informationen -->
        <div class="space-y-6">
          <div>
            <label for="signup-vorname" class="block md:text-lg font-bold mb-2 uppercase">Vorname</label>
            <input
              id="signup-vorname"
              type="text"
              name="vorname"
              class="input-field"
              placeholder="Max"
              autocomplete="given-name"
              required
            />
          </div>

          <div>
            <label for="signup-name" class="block md:text-lg font-bold mb-2 uppercase">Name</label>
            <input
              id="signup-name"
              type="text"
              name="name"
              class="input-field"
              placeholder="Mustermann"
              autocomplete="family-name"
              required
            />
          </div>

          <div>
            <label for="signup-geburtsdatum" class="block md:text-lg font-bold mb-2 uppercase">Geburtsdatum</label>
            <input
              id="signup-geburtsdatum"
              type="date"
              name="geburtsdatum"
              class="input-field"
              required
            />
            <p class="text-sm opacity-70 italic">Jahrgänge 2009 - 2014</p>
          </div>


        </div>

        <!-- Kontaktdaten -->
        <div class="space-y-6 mt-12">
          <div>
            <label for="signup-erziehungsberechtigte" class="block md:text-lg font-bold mb-2 uppercase">Erziehungsberechtigte/r</label>
            <input
              id="signup-erziehungsberechtigte"
              type="text"
              name="erziehungsberechtigte"
              class="input-field"
              placeholder="Namen der Erziehungsberechtigten"
              required
            />
          </div>



          <div>
            <label for="signup-email" class="block md:text-lg font-bold mb-2 uppercase">E-Mail</label>
            <input
              id="signup-email"
              type="email"
              name="email"
              class="input-field"
              placeholder="erziehungsberechtigte@beispiel.com"
              autocomplete="email"
              required
            />
          </div>

          <div>
            <label for="signup-mobil-nr" class="block md:text-lg font-bold mb-2 uppercase">Mobil-Nr</label>
            <input
              id="signup-mobil-nr"
              type="tel"
              name="mobil_nr"
              class="input-field"
              placeholder="+49 123 456789"
              autocomplete="tel"
              required
            />
            <p class="text-sm opacity-70 italic">Um euch im Notfall erreichen zu können, benötigen wir eine Mobilnummer.</p>
          </div>

          <div>
            <label for="signup-strasse" class="block md:text-lg font-bold mb-2 uppercase">Straße</label>
            <input
              id="signup-strasse"
              type="text"
              name="strasse"
              class="input-field"
              placeholder="Musterstraße 123"
              autocomplete="street-address"
              required
            />
          </div>

          <div>
            <label for="signup-plz" class="block md:text-lg font-bold mb-2 uppercase">PLZ</label>
            <input
              id="signup-plz"
              type="text"
              name="plz"
              class="input-field"
              placeholder="39104"
              autocomplete="postal-code"
              required
            />
          </div>

          <div>
            <label for="signup-ort" class="block md:text-lg font-bold mb-2 uppercase">Ort</label>
            <input
              id="signup-ort"
              type="text"
              name="ort"
              class="input-field"
            />
          </div>
        </div>

        <!-- Camp-Informationen -->
        <div class="space-y-6 mt-12">
          <div>
            <label for="signup-tshirt-groesse" class="block md:text-lg font-bold mb-2 uppercase">T-Shirt Größe</label>
            <select id="signup-tshirt-groesse" name="tshirt_groesse" class="input-field" required>
              <option value="">Bitte wählen</option>
              <option value="XS">XS</option>
              <option value="S">S</option>
              <option value="M">M</option>
              <option value="L">L</option>
              <option value="XL">XL</option>
              <option value="XXL">XXL</option>
            </select>
          </div>

          <div>
            <label class="flex items-center gap-2 md:text-lg mb-2">
              <input type="checkbox" id="signup-geschwisterkind" name="geschwisterkind" class="w-5 h-5 shrink-0" />
              <span class="uppercase font-bold">Geschwisterkind</span>
            </label>
            <p class="text-sm opacity-70 mb-2 italic">Bitte ankreuzen, wenn das hier angemeldete Kind ein Geschwisterkind einer bereits angemeldeten Person ist.</p>
            <input
              id="signup-geschwisterkind-name"
              type="text"
              name="geschwisterkind_name"
              class="input-field mt-2"
              placeholder="Name des Geschwisterkindes"
            />
          </div>
        </div>

        <!-- Gesundheit & Ernährung -->
        <div class="space-y-6 mt-12">
          <div>
            <label for="signup-ernaehrung" class="block md:text-lg font-bold mb-2 uppercase">Ernährung</label>
            <select id="signup-ernaehrung" name="ernaehrung" class="input-field" required>
              <option value="">Bitte wählen</option>
              <option value="mit-fleisch">Mit Fleisch</option>
              <option value="vegetarisch">Vegetarisch</option>
              <option value="vegan">Vegan</option>
            </select>
          </div>

          <div>
            <label for="signup-medizinische-hinweise" class="block md:text-lg font-bold mb-2 uppercase">Medizinische Hinweise</label>
            <textarea
              id="signup-medizinische-hinweise"
              name="medizinische_hinweise"
              class="input-field"
              rows="3"
              placeholder="z.B. Medikamente, Allergien, körperliche Einschränkungen, etc."
            ></textarea>
          </div>
        </div>

        <!-- Einverständniserklärungen -->
        <div class="mt-12">
          <p class="mb-4">Ich, als Erziehungsberechtigte/r, gebe mein Einverständnis, dass</p>
          <div class="space-y-3 pl-4">
            <label class="flex items-center gap-2 text-base">
              <input type="checkbox" name="einverstaendnis_fotos_videos" class="w-5 h-5 shrink-0" required />
              <span>Fotos und Videos von meinem Kind gemacht, gespeichert und öffentlich verwendet werden dürfen.</span>
            </label>
            <label class="flex items-center gap-2 text-base">
              <input type="checkbox" name="verbindliche_teilnahme" class="w-5 h-5 shrink-0" required />
              <span>ich mein Kind verbindlich zum Baseball Camp anmelde</span>
            </label>
            <label class="flex items-center gap-2 text-base">
              <input type="checkbox" name="information_angebote_eastside" class="w-5 h-5 shrink-0" />
              <span>ich weitere Informationen zu anderen Angeboten der EASTSIDE. jugendgemeinde erhalten möchte (freiwillig)</span>
            </label>
          </div>
        </div>
        <br>
        <button type="submit" class="btn-primary w-full">Jetzt Anmelden</button>
      </form>
    </div>
  </div>
</section>

<script is:inline>
  const form = document.getElementById("signup-form");
  const statusDiv = document.getElementById("form-status");

  if (form && statusDiv) {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const submitButton = form.querySelector('button[type="submit"]');
      if (!submitButton) return;

      const originalText = submitButton.textContent || "";
      submitButton.disabled = true;
      submitButton.textContent = "Wird gesendet...";

      try {
        const formData = new FormData(form);
        const response = await fetch("https://api.web3forms.com/submit", {
          method: "POST",
          body: formData,
        });

        const data = await response.json();

        if (data.success) {
          statusDiv.className = "p-4 rounded border-2 border-white font-bold text-center bg-green-500/20 text-green-200";
          statusDiv.textContent = "✓ Anmeldung erfolgreich! Wir haben deine Anmeldung erhalten und melden uns bald bei dir.";
          statusDiv.classList.remove("hidden");
          form.reset();
          statusDiv.focus();
          window.scrollTo({ top: form.offsetTop - 100, behavior: "smooth" });
        } else {
          throw new Error(data.message || "Ein Fehler ist aufgetreten");
        }
      } catch (error) {
        statusDiv.className = "p-4 rounded border-2 border-white font-bold text-center bg-red-500/20 text-red-200";
        statusDiv.textContent = "✗ Fehler beim Senden. Bitte versuche es erneut oder kontaktiere uns direkt per E-Mail.";
        statusDiv.classList.remove("hidden");
        statusDiv.focus();
      } finally {
        submitButton.disabled = false;
        submitButton.textContent = originalText;
      }
    });
  }
</script>
