<section class="section pt-0! mt-0">
  <div class="max-w-2xl mx-auto">
    <div class="card">
      <form
        action="https://api.web3forms.com/submit"
        method="POST"
        class="space-y-6"
        id="signup-form"
      >
        <input type="hidden" name="access_key" value="03f3b4a3-d2e9-40d4-8cef-a3d67718637d" />
        <input type="hidden" name="subject" value="Neue Anmeldung - Magdeburger Baseball Camp" />
        <input type="hidden" name="from_name" value="Baseball Camp Anmeldung" />
        
        <div id="form-status" role="alert" aria-live="polite" tabindex="-1" class="hidden p-4 rounded border-2 border-white font-bold text-center"></div>

        <div>
          <label for="signup-name" class="block text-lg font-bold mb-2 uppercase">Name</label>
          <input
            id="signup-name"
            type="text"
            name="name"
            class="input-field"
            placeholder="Max Mustermann"
            autocomplete="name"
            required
          />
        </div>
        <div>
          <label for="signup-email" class="block text-lg font-bold mb-2 uppercase">E-Mail</label>
          <input
            id="signup-email"
            type="email"
            name="email"
            class="input-field"
            placeholder="max@beispiel.de"
            autocomplete="email"
            required
          />
        </div>
        <div>
          <label for="signup-phone" class="block text-lg font-bold mb-2 uppercase">Telefon</label>
          <input
            id="signup-phone"
            type="tel"
            name="phone"
            class="input-field"
            placeholder="+49 123 456789"
            autocomplete="tel"
            required
          />
        </div>
        <div>
          <label for="signup-jahrgang" class="block text-lg font-bold mb-2 uppercase">Jahrgang</label>
          <input
            id="signup-jahrgang"
            type="number"
            name="jahrgang"
            class="input-field"
            placeholder="z.B. 2012"
            min="2009"
            max="2014"
            required
          />
          <p id="signup-jahrgang-hint" class="text-sm opacity-70 mt-1 italic">Teilnahme für Jahrgänge 2009 bis 2014</p>
        </div>
        <div>
          <label for="signup-erfahrungslevel" class="block text-lg font-bold mb-2 uppercase">Erfahrungslevel</label>
          <select id="signup-erfahrungslevel" name="erfahrungslevel" class="input-field" required>
            <option value="">Bitte wählen</option>
            <option value="beginner">Anfänger (noch nie/fast noch nie gespielt)</option>
            <option value="intermediate">Fortgeschritten (schon häufiger gespielt)</option>
            <option value="advanced">Erfahren</option>
          </select>
        </div>
        <div>
          <label class="flex items-center gap-2 text-lg">
            <input id="signup-terms" type="checkbox" name="terms_accepted" class="w-5 h-5" required />
            <span>
              Ich akzeptiere die{" "}
              <a href="/teilnahmebedingungen" class="underline hover:opacity-80" target="_blank">
                Teilnahmebedingungen
              </a>{" "}
              und{" "}
              <a href="/datenschutzerklärung" class="underline hover:opacity-80" target="_blank">
                Datenschutzerklärung
              </a>
            </span>
          </label>
        </div>
        <button type="submit" class="btn-primary w-full">Jetzt Anmelden</button>
      </form>
    </div>
  </div>
</section>

<script is:inline>
  const form = document.getElementById("signup-form");
  const statusDiv = document.getElementById("form-status");

  if (form && statusDiv) {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const submitButton = form.querySelector('button[type="submit"]');
      if (!submitButton) return;

      const originalText = submitButton.textContent || "";
      submitButton.disabled = true;
      submitButton.textContent = "Wird gesendet...";

      try {
        const formData = new FormData(form);
        const response = await fetch("https://api.web3forms.com/submit", {
          method: "POST",
          body: formData,
        });

        const data = await response.json();

        if (data.success) {
          statusDiv.className = "p-4 rounded border-2 border-white font-bold text-center bg-green-500/20 text-green-200";
          statusDiv.textContent = "✓ Anmeldung erfolgreich! Wir haben deine Anmeldung erhalten und melden uns bald bei dir.";
          statusDiv.classList.remove("hidden");
          form.reset();
          statusDiv.focus();
          window.scrollTo({ top: form.offsetTop - 100, behavior: "smooth" });
        } else {
          throw new Error(data.message || "Ein Fehler ist aufgetreten");
        }
      } catch (error) {
        statusDiv.className = "p-4 rounded border-2 border-white font-bold text-center bg-red-500/20 text-red-200";
        statusDiv.textContent = "✗ Fehler beim Senden. Bitte versuche es erneut oder kontaktiere uns direkt per E-Mail.";
        statusDiv.classList.remove("hidden");
        statusDiv.focus();
      } finally {
        submitButton.disabled = false;
        submitButton.textContent = originalText;
      }
    });
  }
</script>
